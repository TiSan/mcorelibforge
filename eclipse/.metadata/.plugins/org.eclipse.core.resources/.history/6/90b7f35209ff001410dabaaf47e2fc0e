package de.tisan.forge.helpers;

import java.util.ArrayList;

import net.minecraft.nbt.NBTTagCompound;
import cpw.mods.fml.common.network.NetworkRegistry;
import cpw.mods.fml.common.network.simpleimpl.SimpleNetworkWrapper;

public class Communication {

	private SimpleNetworkWrapper channel;
	private String name;
	private ArrayList<CommunicationEvent> events;

	protected Communication(String name) {
		this.name = name;
		events = new ArrayList<CommunicationEvent>();
		channel = NetworkRegistry.INSTANCE.newSimpleChannel("BUKKITCHAN:" + name);
	}

	public void addEvent(CommunicationEvent event) {
		events.add(event);
	}
	
	public void sendToServer(NBTTagCompound tag){
		channel.sendToServer(new ClientToServerMessage(tag, this));
	}
	
	protected void pushServerEvent(NBTTagCompound tag) {
		for(CommunicationEvent e : events){
			e.onClientToServerMessageReceived(tag);
		}
	}
	protected void pushClientEvent(NBTTagCompound tag) {
		for(CommunicationEvent e : events){
			e.onServerToClientMessageReceived(tag);
		}
	}
}
